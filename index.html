<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link id="icon" rel="icon" href="" type="image/png">  
  <title id="page"></title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

  /* ===== Loading Screen Styles ===== */
  #loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    transition: opacity 0.5s ease;
  }
  
  .loading-spinner-large {
    border: 5px solid rgba(100, 149, 237, 0.1);
    border-top: 5px solid rgba(26, 26, 26, 1);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    color: rgba(26, 26, 26, 1);
    animation: spin 0.8s linear infinite;
    margin-bottom: 10px;
  }
  
  :root {
    --primary: #3ba7ff;
    --primary-dark: #417cb8;
    --primary-light: #7fb3d5;
    --secondary: #88c1e0;
    --dark: #010326;
    --darker: #010326;
    --light: #ffffff;
    --gray: rgba(0, 0, 0, 0.6);
    --light-gray: #ecf0f1;
    --lighter-gray: #f5f7f8;
    --success: #27ae60;
    --warning: #f39c12;
    --danger: #e74c3c;
    --card-bg: #ffffff;
    --card-hover: #f5f9fc;
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }
  
  .loading-text {
    color: var(--darker);
    font-size: 0.8rem;
    margin-top: 5px;
    text-align: center;
    font-weight: 500;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Poppins', serif;
    background-color: #ffffff;
    color: #2c3e50;
    padding: 1.5rem;
    min-height: 100vh;
    -webkit-tap-highlight-color: transparent;
    line-height: 1.5;
  }

  .d-none {
    display: none !important;
  }
  
#apiLinks {
  display: flex;
  flex-direction: column; /* atau row, bebas */
  align-items: flex-start; /* penting agar <a> tidak memanjang */
  gap: 3px;
}


#apiLinks span {
font-size: 0.90rem;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.8);
}

#apiLinks a {
  display: inline-block;
  width: auto;
  white-space: nowrap;
  font-size: 0.85rem;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.8);
  text-decoration: none;
  transition: background 0.3s ease;
}

  
#apiLinks #contactdev {
background: #f7f7f7;
}

  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow-x: auto;
    background: #ffffff;
    color: rgba(26, 26, 26, 1);
    padding: 0.5rem;
    max-height: 400px;
    font-size: 0.85rem;    
    font-weight: 500;
    font-family: 'Poppins', serif;
  }

  /* ===== Form Styles ===== */
  .modal-body form label {
    display: block;
    font-weight: 500;
    margin-bottom: 6px;
    color: var(--dark);
    font-size: 0.9rem;
  }

  .modal-body form input {
    width: 100%;
    padding: 12px 14px;
    border: 0.8px solid #bdc3c7;
    background: #f7f7f7;
    color: var(--darker);
    margin-bottom: 0.5rem;
    font-weight: 500;
    font-size: 0.80rem;
    transition: var(--transition);
    font-family: 'Poppins', serif;
  }

  .modal-body form input::placeholder {
    color: rgba(0, 0, 0, 0.5);
  }

  .modal-body form input:focus {
    outline: none;
    box-shadow: 0 0 0 1.2px var(--darker);
  }

  #submitParamBtn {
    background: var(--darker);
    color: white;
    border: none;
    padding: 12px 24px;
    font-size: 0.80rem;
    font-family: 'Poppins', serif;
    font-weight: 500;
    cursor: pointer;
    transition: var(--transition);
    width: 100%;
    margin-top: 0.5rem;
  }

  #submitParamBtn:hover {
    background: var(--darker);
    transform: translateY(-2px);
  }

  #submitParamBtn:active {
    transform: translateY(0);
  }

  .loading-spinner {
    margin: 2rem auto 0.5rem auto;
    border: 3px solid rgba(91, 155, 213, 0.1);
    border-top: 3px solid rgba(26, 26, 26, 1);
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 0.8s linear infinite;
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }
  
  .title-container {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 1.20rem;
  }
  
  .icon-title {
    font-size: 2.1rem;
    color: var(--primary);
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  /* ===== Modal Styles ===== */
  .modal {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 100;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(8px);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }

  .modal.active {
    opacity: 1;
    pointer-events: all;
  }

  .modal-dialog {
    width: 100%;
    max-width: 500px;
    background: #ffffff;
    padding: 1rem;
    color: var(--dark);
    overflow: hidden;
    transform: translateY(20px);
    transition: transform 0.3s ease, opacity 0.3s ease;
    opacity: 0;
    border: 1px solid #dfe6e9;
  }

  .modal.active .modal-dialog {
    transform: translateY(0);
    opacity: 1;
  }

  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 0.3rem;
  }

  .modal-header h5 {
    font-size: 0.90rem;
    font-weight: 500;
    color: var(--darker);
    margin-bottom: 5px;
  }

  .modal-header span {
    font-size: 0.80rem;
    color: var(--gray);
    display: block;
    font-weight: 500;
  }

  .btn-close {
    background: none;
    border: none;
    font-size: 2rem;
    line-height: 1;
    cursor: pointer;
    color: var(--darker);
    transition: var(--transition);
    padding: 0.25rem;
    font-weight: 400;
  }

  .btn-close:hover {
    color: var(--darker);
    background: var(--lighter-gray);
  }

  /* ===== Modal Body Content ===== */
  .modal-body {
    padding: 0.5rem 0;
  }

  .copy-section {
    display: none;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    background: #f7f7f7;
    padding: 10px 14px;
    font-size: 0.80rem;
    color: var(--darker);
    margin-bottom: 1rem;
    overflow: scroll;
    font-weight: 500;
    transition: var(--transition);
  }
  
  .copy-section::-webkit-scrollbar {
    display: none;
    height: 0;
  }

  .copy-section.active {
    display: flex;
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  #apiResponseContent {
    background-color: #ffffff;
    padding: 1rem;
    border: 2px solid #dfe6e9;
    font-size: 0.9rem;
    max-height: 400px;
    overflow-y: auto;
    margin-top: 15px;
    white-space: pre-wrap;
    word-wrap: break-word;
    transition: var(--transition);
  }
  
  #apiResponseContent::-webkit-scrollbar {
    display: none;
  }

  .image-response {
    max-width: 100%;
    max-height: 300px;
    display: block;
    margin: 0 auto;
    box-shadow: var(--shadow-sm);
  }
  
  .video-response {
     max-width: 100%;
     height: auto;
   }
   
   .audio-response {
     width: 100%;
     margin-top: 10px;
   }

  /* ===== Page Sections ===== */
  .container {
    max-width: 1300px;
    margin: 5rem 0 auto;
    padding: 0 0.8rem;
  }

  header h1 {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 2rem;
    color: var(--darker);
  }

  .hero {
    text-align: left;
    margin: 2.5rem 0rem;
    max-width: 800px;
  }

  .hero h2 {
    font-size: 2rem;
    font-weight: 500;
    color: var(--darker);
    margin-bottom: -15px;
    animation: gradient 8s ease infinite;
  }

  @keyframes gradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .hero p {
    font-size: 0.9rem;
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 1.5rem;
    font-weight: 500;
    font-family: 'Poppins', serif;
  }

  .content h2 {
    font-size: 1.5rem;
    color: var(--darker);
    margin-bottom: 1rem;
    font-weight: 500;
  }

  /* ===== Tabs ===== */
  .tabs {
    display: flex;
    gap: 1rem;
    overflow-x: auto;
    margin-bottom: 0.8rem;
    padding-bottom: 6px;
    scrollbar-width: none;
  }

  .tabs::-webkit-scrollbar {
    display: none;
    height: 0;
  }

  .tab {
    background: none;
    color: rgba(0, 0, 0, 0.6);
    border: none;
    font-weight: 500;
    font-family: 'Poppins', serif;
    border-bottom: 2px solid transparent;
    padding: 0.05rem 0;
    cursor: pointer;
    font-size: 0.90rem;
    white-space: nowrap;
    position: relative;
  }

  .tab.active {
    border-bottom: 2.5px solid var(--darker);
    color: var(--darker);
  }

  .tab:after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 0;
    height: 2px;
  }

  .tab:hover:not(.active):after {
    width: 100%;
  }

  /* ===== API Card Animations ===== */
  .api-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 0.4rem;
    margin-bottom: 2rem;
  }

  /* ===== API Cards ===== */
  .api-card {
    background: #f7f7f7;
    padding: 0.90rem 0.8rem;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
    display: flex;
    justify-content: space-between;
    align-items: center;
    min-height: 35px;
    opacity: 0;
    transform: translateY(20px);
    animation: cardEntrance 0.6s ease-out forwards;
    position: relative;
    overflow: hidden;
  }

  .api-card:hover {
    box-shadow: 0 10px 20px rgba(0,0,0,0.15);
    
  }

  .api-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .api-card:hover::before {
    opacity: 1;
  }

  .api-card:hover .play-button {
    transform: translateX(3px);    
  }

  .api-info {
    flex: 1;
    padding-right: 1rem;
  }

  .play-button {
    background: var(--darker);
    border: none;
    padding: 8px 10px;
    color: rgba(255, 255, 255, 1);
    cursor: pointer;
    font-size: 0.80rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    align-self: center;
    margin-top: 0;
    white-space: nowrap;
  }

  @keyframes cardEntrance {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .api-info h3 {
    font-size: 0.90rem;
    color: var(--darker);
    font-weight: 500;
    margin-bottom: 5px;
  }
  
  .api-info h3 span {
  font-size: 0.80rem;
  font-weight: 500;
  padding: 0.1rem 0.2rem;
  margin-right: 2px;
  background: rgba(74, 143, 255, 0.2);
  }

  .api-info p {
    font-size: 0.80rem;
    color: var(--gray);
    font-weight: 500;
    line-height: 1.5;
    
  }

  .play-button:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
  }

  .play-button:active {
    transform: translateY(0);
  }

  .contact {
    margin-top: 1rem;
    display: flex;
    justify-content: center;
    gap: 1rem;
  }

  .contact a {
    color: rgba(0, 0, 0, 0.6);
    text-decoration: none;
    font-size: 1.25rem;
    transition: var(--transition);
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: var(--lighter-gray);
  }

  .contact a:hover {
    color: white;
    background: var(--darker);
    transform: translateY(-3px);
    box-shadow: var(--shadow);
  }

  /* ===== Animations ===== */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .fade-in {
    animation: fadeInUp 0.6s ease forwards;
  }

  /* ===== Responsive ===== */
  @media (max-width: 768px) {
    body {
      padding: 1rem;
    }
    
    .hero h2 {
      font-size: 1.8rem;
    }
    
    .hero p {
      font-size: 0.80rem;
    }
    
    .api-list {
      grid-template-columns: 1fr;
    }
    
  }

  @media (max-width: 480px) {
    .hero h2 {
      font-size: 1.7rem;
    }
    
    .modal-dialog {
      padding: 1.25rem;
    }
  }
  
  /* Navbar Styles */
.navbar {
  background: #fff;
  border-bottom: 1.2px solid #eee;
  padding: 14px;
  position: fixed;
  top: 0;
  right: 0;
  left: 0;
  z-index: 1;
}

.navbar-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 0.8rem;
}

.brand {
  font-size: 1.2rem;
  font-weight: 500;
  color: var(--dark);
  font-family: 'Poppins', serif;
}

.navbar-right .nav-icon {
  color: #4caf50;
  font-size: 1.2rem;
  text-decoration: none;
  padding: 6px;
  transition: color 0.3s ease;
}

.navbar-right .nav-icon:hover {
  color: #388e3c;
}
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="loading-spinner-large"></div>
    <div class="loading-text"></div>
  </div>
  
  <header class="navbar">
  <div class="navbar-container">
    <div class="navbar-left">
      <span id ="navname" class="brand">X-Skycode</span>
    </div>
    <div class="navbar-right">
      <a id="WhatsApp" href="https://wa.me/yourwhatsapplink" class="nav-icon" aria-label="WhatsApp Support">
        <i class="fab fa-whatsapp"></i>
      </a>
    </div>
  </div>
</header>

  <div class="container">
    <section class="hero fade-in">
      <div class="title-container">
        <h2 id="apiTitle"></h2>
      </div>
      <p>Simple and fast API for full-featured WhatsApp Bot integration.</p>
          <section id="apiLinks">
    <span>Base URL: </span><a id="contactdev" href="#" title="Contact Dev"></a>
    </section>
    </section>

    <section class="content">
      <div class="tabs" id="tabs"></div>
      <div id="api-list" class="api-list"></div>
    </section>
  </div>

  <!-- Modal for API Response -->
  <div class="modal" id="apiResponseModal">
    <div class="modal-dialog">
      <div class="modal-header">
        <div>
          <h5></h5>
          <span id="desc"></span>
        </div>
        <button id="btn-close" class="btn-close">×</button>
      </div>
      <div class="modal-body">
        <div class="copy-section">
          <span id="copyEndpointText"></span>
        </div>
        <form id="paramForm" style="margin-bottom: 0.5rem"></form>
        <button id="submitParamBtn" type="button">Submit Request</button>
        <div id="apiResponseLoading" class="loading-spinner" style="display: none;"></div>
        <div id="apiResponseContent" class="d-none"></div>
      </div>
    </div>
  </div>
<script>
document.addEventListener('DOMContentLoaded', async () => {
  document.querySelector('.container').style.display = 'none';

  const tabsContainer = document.getElementById("tabs");
  const apiList = document.getElementById("api-list");
  const paramForm = document.getElementById("paramForm");
  const submitBtn = document.getElementById("submitParamBtn");
  const modal = document.getElementById("apiResponseModal");
  const responseEl = document.getElementById("apiResponseContent");
  const loadingEl = document.getElementById("apiResponseLoading");
  const urlsSection = document.querySelector(".copy-section");

  let currentEndpoint = "";
  let settings = {}, apis = {};

  try {
    settings = await fetch("/set").then(res => res.json());
    apis = await fetch("/endpoints").then(res => res.json());
  } catch (err) {
    console.error("Gagal memuat konfigurasi API:", err);

    document.getElementById('loading-screen').style.opacity = '0';
    setTimeout(() => {
      document.getElementById('loading-screen').style.display = 'none';
      document.querySelector('.container').style.display = 'block';
    }, 500);
    
    return;
  }

  const iconEl = document.getElementById("icon");
  if (iconEl) iconEl.href = settings.favicon_url || "";

  const head = document.head;
  const ogTags = [
    { property: 'og:title', content: settings.api_title },
    { property: 'og:description', content: "Simple API with easy and minimalistic integration for WhatsApp Bot Developers." },
    { property: 'og:image', content: settings.favicon_url },
    { property: 'og:url', content: window.location.href },
    { property: 'og:type', content: 'website' }
  ];
  ogTags.forEach(({ property, content }) => {
    const meta = document.createElement('meta');
    meta.setAttribute('property', property);
    meta.setAttribute('content', content);
    head.appendChild(meta);
  });

  const setContent = (id, prop, val) => {
    const el = document.getElementById(id);
    if (el) el[prop] = val;
  };

  setContent("page", "textContent", "Docs - " + (settings.api_title || "Skyzopedia API"));
  setContent("apiTitle", "textContent", settings.api_title || "Skyzopedia API");
  setContent("contactdev", "textContent", window.location.origin || "#");
  setContent("contactdev", "href", window.location.origin || "#");
  setContent("WhatsApp", "href", settings.contact_whatsapp || "#");
  setContent("navname", "textContent", settings.creator_name || "#");

  const categories = Object.keys(apis);
  if (categories.length === 0) return;

  categories.forEach((key, i) => {
    const btn = document.createElement("button");
    btn.className = `tab`;
    btn.dataset.tab = key;
    btn.textContent = key;
    tabsContainer.appendChild(btn);
  });

  function renderAPIs(category) {
    apiList.innerHTML = "";
    if (!apis[category]) return;

    apis[category].sort((a, b) => a.name.localeCompare(b.name)).forEach((api, i) => {
      const card = document.createElement("div");
      card.className = "api-card";
      card.innerHTML = `
        <div class="api-info">
          <h3><span id="method">GET</span> ${api.name}</h3>
          ${api.desc ? `<p>${api.desc}</p>` : ""}
        </div>
        <button class="play-button" data-endpoint="${api.path}" data-api="${api.name}" data-desc="${api.desc}">
          <i class="fa-solid fa-play"></i>
        </button>
      `;
      apiList.appendChild(card);
      setTimeout(() => {
        card.style.animation = `cardEntrance 0.6s ease-out ${i * 0.1}s forwards`;
      }, 10);
    });
  }

  // === Custom kategori pertama yang ditampilkan ===
  const defaultCategory = categories[1] // <-- Ubah ini sesuai kategori yang kamu mau
  const initialCategory = apis[defaultCategory] ? defaultCategory : categories[0];
  renderAPIs(initialCategory);

  // Tandai tab aktif
  const activeTab = [...tabsContainer.querySelectorAll(".tab")]
    .find(tab => tab.dataset.tab === initialCategory);
  if (activeTab) {
    document.querySelectorAll(".tab").forEach(tab => tab.classList.remove("active"));
    activeTab.classList.add("active");
  }

  // Event click tab
  tabsContainer.addEventListener("click", (e) => {
    const tabBtn = e.target.closest(".tab");
    if (!tabBtn || !tabBtn.dataset.tab) return;

    document.querySelectorAll(".tab").forEach(tab => tab.classList.remove("active"));
    tabBtn.classList.add("active");

    const selectedCategory = tabBtn.dataset.tab;
    if (apis[selectedCategory]) {
      renderAPIs(selectedCategory);
    }
  });

  document.addEventListener("click", (e) => {
    if (e.target.closest(".play-button")) {
      const btn = e.target.closest(".play-button");
      const endpoint = btn.getAttribute("data-endpoint");
      const api = btn.getAttribute("data-api");
      const desc = btn.getAttribute("data-desc");

      const method = btn.parentElement.querySelector(".api-method")?.textContent?.trim() || "GET";

      currentEndpoint = endpoint;

      const h5 = document.querySelector(".modal-dialog h5");
      h5.innerHTML = `
        <span id="method" style="
          display: inline-block;
          font-size: 0.80rem;
          font-weight: 500;
          color: var(--darker);
          padding: 0.1rem 0.2rem;
          margin-right: 6px;
          background: rgba(74, 143, 255, 0.2);
        ">${method}</span>${api}`;

      document.querySelector(".modal-dialog #desc").textContent = desc;

      responseEl.textContent = "";
      responseEl.classList.add("d-none");
      loadingEl.style.display = "none";
      paramForm.style.display = "block";
      submitBtn.style.display = "none";
      paramForm.innerHTML = "";

      if (endpoint.includes("?")) {
        const queryParams = endpoint.split("?")[1].split("&");
        queryParams.forEach(param => {
          const [key, value] = param.split("=");
          paramForm.innerHTML += `
            <input type="text" id="${key}" name="${key}" value="${value || ''}" placeholder="Input ${key}" required />
          `;
        });
        submitBtn.style.display = "block";
      } else {
        fetchAPI(endpoint);
      }

      modal.classList.add("active");
      urlsSection.classList.add("active");
      document.getElementById("copyEndpointText").textContent = window.location.origin + endpoint;
    }

    if (e.target.id === "btn-close" || e.target === modal) {
      modal.classList.remove("active");
      document.body.style.overflow = '';
    }
  });

  submitBtn.addEventListener("click", () => {
    if (!paramForm.checkValidity()) {
      paramForm.reportValidity();
      return;
    }

    paramForm.style.display = "none";
    submitBtn.style.display = "none";
    loadingEl.style.display = "block";

    let endpoint = currentEndpoint.split("?")[0] + "?";
    const inputs = paramForm.querySelectorAll("input");
    inputs.forEach((input, index) => {
      endpoint += `${input.name}=${encodeURIComponent(input.value)}`;
      if (index < inputs.length - 1) endpoint += "&";
    });

    fetchAPI(endpoint);
  });

  setTimeout(() => {
    document.getElementById('loading-screen').style.opacity = '0';
    setTimeout(() => {
      document.getElementById('loading-screen').style.display = 'none';
      document.querySelector('.container').style.display = 'block';
    }, 500);
  }, 1000);

  function fetchAPI(endpoint) {
    const fullURL = window.location.origin + endpoint;

    paramForm.style.display = "none";
    submitBtn.style.display = "none";
    loadingEl.style.display = "block";
    responseEl.classList.add("d-none");
    responseEl.innerHTML = "";
    urlsSection.classList.add("active");
    document.getElementById("copyEndpointText").textContent = fullURL;

    fetch(fullURL)
      .then(async (res) => {
        loadingEl.style.display = "none";
        const contentType = res.headers.get("content-type");

        if (contentType.includes("application/json")) {
          const data = await res.json();
          responseEl.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
        } else if (contentType.startsWith("image/")) {
          const blob = await res.blob();
          responseEl.innerHTML = `<img src="${URL.createObjectURL(blob)}" class="image-response" />`;
        } else if (contentType.startsWith("video/")) {
          const blob = await res.blob();
          responseEl.innerHTML = `
            <video controls class="video-response" autoplay>
              <source src="${URL.createObjectURL(blob)}" type="${contentType}">
              Your browser does not support the video tag.
            </video>`;
        } else if (contentType.startsWith("audio/")) {
          const blob = await res.blob();
          responseEl.innerHTML = `
            <audio controls class="audio-response" autoplay>
              <source src="${URL.createObjectURL(blob)}" type="${contentType}">
              Your browser does not support the audio tag.
            </audio>`;
        } else {
          const text = await res.text();
          responseEl.innerHTML = `<pre>${text.substring(0, 1000)}</pre>`;
        }

        responseEl.classList.remove("d-none");
      })
      .catch((err) => {
        loadingEl.style.display = "none";
        responseEl.classList.remove("d-none");
        responseEl.innerHTML = `<pre>Error: ${err.message}</pre>`;
      });
  }
});
</script>
    </body>
  </html>
